import sqlite3


def reset_both_queues():
    conn = sqlite3.connect('real_estate.db')
    cursor = conn.cursor()

    print("üîÑ –°–ë–†–û–° –û–ë–ï–ò–• –û–ß–ï–†–ï–î–ï–ô")
    print("=" * 40)

    # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—á–µ—Ä–µ–¥—å –¥–ª—è –ö–ê–ñ–î–û–ì–û –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
    objects = [
        (1, '–ñ–ö ‚Ññ1 –°–µ–º–µ–π–Ω–∞—è –ò–ø–æ—Ç–µ–∫–∞ –æ—Ç 5,9%'),
        (2, '–ñ–ö ‚Ññ2 –°–µ–º–µ–π–Ω–∞—è –ò–ø–æ—Ç–µ–∫–∞ –æ—Ç 3,5%')
    ]

    for object_id, object_name in objects:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö –∞–≥–µ–Ω—Ç–æ–≤ —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞
        cursor.execute('''
            SELECT id FROM agents 
            WHERE object_id = ? 
            ORDER BY id
        ''', (object_id,))

        agents = cursor.fetchall()

        # –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –ø–æ—Ä—è–¥–æ–∫ 1,2,3... –¥–ª—è –ö–ê–ñ–î–û–ì–û –æ–±—ä–µ–∫—Ç–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
        for order, agent in enumerate(agents, 1):
            cursor.execute('UPDATE agents SET queue_order = ? WHERE id = ?', (order, agent[0]))

        print(f"‚úÖ {object_name}: –æ—á–µ—Ä–µ–¥—å —Å–±—Ä–æ—à–µ–Ω–∞ (1-{len(agents)})")

    conn.commit()

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    print("\nüìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –û–ß–ï–†–ï–î–ï–ô:")
    print("=" * 40)

    for object_id, object_name in objects:
        cursor.execute('''
            SELECT username, queue_order 
            FROM agents 
            WHERE object_id = ? 
            ORDER BY queue_order
        ''', (object_id,))

        agents = cursor.fetchall()
        print(f"\nüè¢ {object_name}:")
        for agent in agents:
            print(f"   {agent[1]}. @{agent[0]}")

    conn.close()
    print("\nüéâ –û–±–µ –æ—á–µ—Ä–µ–¥–∏ —Å–±—Ä–æ—à–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ!")


if __name__ == "__main__":
    reset_both_queues()